(ns palette.core
  (:require [clojure.string :as s]))

(defn parse-hex-color [hex-string]
  (let [to-hex (fn [s]
                 (apply str
                        (cons "0x" s)))
        rgb (rest hex-string)
        r (take 2 rgb)
        g (take 2 (drop 2 rgb))
        b (drop 4 rgb)]
    (mapv (comp symbol to-hex) [r g b])))

(defn parse-palette 
  "parses hex RGB palettes in the format [[name [#rrggbb]]]"
  [palette]
  (into {}
        (mapv (fn [[name colors]]
                [(keyword name)
                 (mapv parse-hex-color
                       colors)])
              palette)))

(defn parse-r-palette
  "quotations must be escaped
   example format: 
   'list(name = c('#001122',#334455,))'"
  [r-list]
  (parse-palette
   (mapv (fn [r-color]
           (let [split-s (s/split r-color " ")
                 name (first split-s)
                 colors (->> split-s
                             (drop 2)
                             (map #(apply str
                                          (-> %
                                              (s/replace "," "")
                                              (s/replace "c(" "")
                                              (s/replace ")" "")
                                              rest
                                              butlast)))
                             (remove empty?))]
             [name colors]))
         r-list)))

(def met-colors {:Manet
                 [[34 94 146]
                  [210 156 68]
                  [67 66 155]
                  [235 193 116]
                  [69 133 183]
                  [24 53 113]
                  [94 101 190]
                  [128 82 28]
                  [126 197 244]
                  [59 35 25]
                  [237 226 204]]
                 :Hiroshige
                 [[170 220 224]
                  [239 138 71]
                  [55 103 149]
                  [247 170 88]
                  [114 188 213]
                  [255 230 183]
                  [231 98 84]
                  [30 70 110]
                  [255 208 111]
                  [82 143 173]]
                 :Veronese [[44 107 103] [103 50 46] [18 44 67] [153 97 10] [195 143 22] [23 84 73] [110 148 140]]
                 :Navajo [[102 13 32] [229 154 82] [237 206 121] [9 69 104] [225 197 154]]
                 :Isfahan1 [[79 182 202] [132 93 41] [5 69 68] [227 194 139] [23 143 146] [78 57 16] [23 95 93] [174 133 72]]
                 :Renoir
                 [[47 53 124]
                  [176 121 154]
                  [230 155 0]
                  [53 88 40]
                  [108 93 158]
                  [191 55 41]
                  [228 129 113]
                  [245 187 80]
                  [157 156 213]
                  [23 21 79]
                  [246 179 176]
                  [173 164 59]]
                 :VanGogh1 [[107 108 163] [135 188 189] [111 153 84] [150 155 199] [137 171 124] [67 68 117] [44 45 84]]
                 :Tsimshian [[38 115 163] [88 35 16] [71 61 125] [49 143 73] [88 35 16] [12 180 187] [130 196 95]]
                 :Nizami [[140 200 188] [184 51 38] [125 167 234] [29 68 151] [200 87 13] [87 115 192] [237 177 68] [221 120 103]]
                 :Lakota [[4 163 189] [240 190 61] [147 30 24] [218 121 1] [36 125 63] [32 35 91]]
                 :Signac
                 [[43 155 129]
                  [254 155 0]
                  [244 196 15]
                  [251 225 131]
                  [99 51 114]
                  [155 52 65]
                  [230 162 166]
                  [146 192 81]
                  [31 110 156]
                  [159 86 145]
                  [232 123 137]
                  [216 68 60]
                  [222 89 124]
                  [170 122 161]]
                 :Hokusai1 [[183 83 71] [34 75 94] [224 147 81] [148 181 148] [237 199 117] [109 47 32] [223 126 102]]
                 :Hokusai3 [[90 151 193] [149 195 110] [41 83 132] [116 200 195] [216 217 122] [10 46 87]]
                 :Juarez [[168 34 3] [32 140 192] [241 175 58] [207 94 78] [99 123 49] [0 57 103]]
                 :Pissaro [[26 82 112] [76 130 93] [141 199 220] [19 65 48] [14 42 77] [80 140 167] [140 174 158]]
                 :VanGogh3 [[30 61 20] [60 124 61] [231 229 204] [102 157 98] [25 40 19] [194 214 164] [156 193 132] [31 91 37]]
                 :OKeeffe2 [[146 53 30] [251 227 194] [185 86 63] [230 156 107] [242 200 143] [211 119 80] [236 178 125]]
                 :Homer1 [[195 244 246] [223 119 0] [166 47 0] [106 213 232] [245 182 66] [50 178 218] [255 241 121] [85 31 0]]
                 :Pillement [[68 99 111] [115 142 142] [105 120 82] [43 70 85] [169 132 91] [15 37 47]]
                 :Monet
                 [[116 158 137]
                  [195 153 162]
                  [125 135 178]
                  [171 204 190]
                  [227 202 207]
                  [194 202 227]
                  [78 109 88]
                  [159 110 113]
                  [65 80 123]]
                 :Thomas [[68 87 165] [196 77 118] [124 175 92] [89 56 108] [178 68 34] [19 49 95] [68 120 97] [177 161 204]]
                 :Homer2 [[249 197 59] [191 54 38] [174 172 76] [22 93 67] [233 133 29] [120 143 51]]
                 :Archambault [[136 160 220] [56 26 97] [124 75 115] [237 150 140] [171 51 41] [231 132 41] [249 209 74]]
                 :Moreau [[121 37 4] [82 123 170] [188 117 36] [141 173 202] [8 40 68] [66 22 0] [16 72 57]]
                 :Wissing [[124 41 30] [186 114 51] [45 83 128] [58 68 33] [75 29 13]]
                 :Johnson [[246 194 0] [160 14 0] [0 134 168] [208 78 0] [19 43 105]]
                 :Cassatt1
                 [[177 97 92] [216 135 130] [227 171 167] [237 215 217] [201 201 221] [157 157 199] [130 130 170] [90 90 131]]
                 :NewKingdom [[158 180 224] [225 132 108] [230 187 158] [156 104 73] [115 88 82]]
                 :Kandinsky [[59 124 112] [206 150 66] [137 142 159] [59 58 62]]
                 :Austria [[164 0 0] [22 49 125] [0 126 47] [255 205 18] [184 96 146] [114 27 62] [0 183 167]]
                 :Peru1 [[28 157 124] [181 54 28] [54 156 201] [227 94 40] [49 199 186] [58 80 127]]
                 :VanGogh2 [[189 49 6] [91 115 20] [69 75 135] [217 112 14] [137 166 187] [238 190 4] [195 214 206] [233 160 14]]
                 :Greek [[141 28 6] [230 116 36] [245 195 77] [60 13 3] [237 155 73]]
                 :Benedictus
                 [[154 19 61]
                  [185 57 97]
                  [216 82 124]
                  [242 138 170]
                  [249 180 201]
                  [249 224 232]
                  [255 255 255]
                  [234 243 255]
                  [197 218 246]
                  [161 194 237]
                  [105 150 227]
                  [64 96 200]
                  [26 49 139]]
                 :Java [[102 49 113] [226 153 138] [207 58 54] [12 113 86] [234 116 40]]
                 :Tam [[239 135 55] [52 22 72] [255 211 83] [159 45 85] [255 178 66] [98 32 95] [222 79 51] [187 41 44]]
                 :Egypt [[221 81 41] [15 123 162] [67 178 132] [250 178 85]]
                 :Redon
                 [[91 133 158]
                  [30 57 95]
                  [117 136 75]
                  [30 90 70]
                  [223 141 113]
                  [175 79 47]
                  [212 143 144]
                  [115 47 48]
                  [171 132 165]
                  [89 56 92]
                  [216 184 71]
                  [179 135 17]]
                 :Klimt [[60 75 153] [201 63 85] [234 204 98] [70 157 118] [146 64 153] [223 158 212]]
                 :Morgenstern
                 [[219 136 114] [255 198 128] [165 100 87] [223 187 200] [255 177 120] [199 162 182] [176 139 165] [152 118 142]]
                 :Tara [[234 177 198] [225 138 31] [211 94 23] [130 157 68] [233 177 9]]
                 :Troy [[108 29 14] [35 80 112] [194 118 104] [123 160 180] [66 20 1] [10 45 70] [139 58 43] [68 114 140]]
                 :Peru2 [[241 148 37] [101 21 11] [192 67 31] [197 147 73] [150 31 31] [83 61 20]]
                 :OKeeffe1
                 [[125 176 234]
                  [246 242 238]
                  [107 32 12]
                  [238 149 106]
                  [34 91 178]
                  [218 108 66]
                  [19 62 126]
                  [251 194 169]
                  [151 61 33]
                  [186 214 249]
                  [68 127 221]]
                 :Gauguin [[129 30 24] [76 98 22] [200 138 44] [158 64 19] [176 73 72] [26 71 42]]
                 :Paquin
                 [[71 99 42]
                  [247 222 163]
                  [131 24 24]
                  [152 171 118]
                  [247 132 98]
                  [240 91 67]
                  [254 172 129]
                  [116 143 70]
                  [198 35 32]
                  [206 209 175]
                  [39 80 36]]
                 :Hokusai2 [[19 75 115] [114 174 182] [47 112 161] [171 201 200] [10 51 81] [70 146 176]]
                 :Isfahan2 [[52 182 198] [221 192 0] [121 173 65] [64 99 163] [215 172 161]]
                 :Tiepolo [[128 36 23] [192 102 54] [23 72 111] [232 185 96] [206 147 68] [100 110 59] [80 142 162] [43 88 81]]
                 :Nattier [[82 39 28] [24 73 72] [192 142 57] [127 121 60] [2 42 42] [148 72 57] [86 92 51]]})

(def pnw-colors
  {:Moth [[74 58 59] [152 65 54] [194 106 122] [236 192 161] [240 240 228]]
   :Winter [[45 41 38] [51 69 78] [83 115 128] [129 169 173] [236 236 236]]
   :Spring [[216 174 221] [191 155 221] [203 116 173] [230 158 156] [255 195 163] [251 228 198]]
   :Sailboat [[110 124 185] [123 188 213] [208 226 175] [245 219 153] [232 156 129] [210 132 141]]
   :Mushroom [[79 65 43] [134 90 60] [186 120 62] [230 156 76] [251 204 116] [255 251 218]]
   :Sunset2 [[29 69 127] [97 89 157] [195 99 119] [235 127 84] [242 175 74]]
   :Sunset [[65 71 107] [103 84 120] [158 99 116] [198 123 111] [222 155 113] [239 188 130] [251 223 162]]
   :Shuksan
   [[51 39 30] [116 103 126] [172 142 171] [215 177 197] [235 189 200] [242 206 199] [248 227 209] [254 251 233]]
   :Lake [[54 41 4] [84 69 15] [69 104 30] [74 145 82] [100 168 168] [133 182 206] [205 229 249] [238 243 255]]
   :Shuksan2 [[93 116 165] [176 203 231] [254 247 199] [235 160 126] [168 85 78]]
   :Bay [[0 73 111] [15 133 160] [237 215 70] [237 139 0] [221 65 36]]
   :Cascades [[45 64 48] [81 104 35] [222 192 0] [226 226 96] [103 126 142] [136 162 185]]
   :Starfish [[36 73 46] [1 91 88] [44 97 132] [89 98 155] [137 104 157] [186 121 153] [230 155 153]]
   :Anemone [[0 148 116] [17 194 181] [114 225 225] [241 244 238] [239 221 207] [220 190 155] [176 152 108]]})

(def r-palette
  {:Zissou1 [[59 154 178] [120 183 197] [235 204 42] [225 175 0] [242 26 0]],
   :Darjeeling1 [[255 0 0] [0 160 138] [242 173 0] [249 132 0] [91 188 214]],
   :Moonrise3 [[133 212 227] [244 181 189] [156 150 74] [205 192 140] [250 215 123]],
   :Rushmore [[225 189 109] [234 190 148] [11 119 94] [53 39 74] [242 48 15]],
   :BottleRocket2 [[250 213 16] [203 35 20] [39 48 70] [53 72 35] [30 30 30]],
   :BottleRocket1 [[164 40 32] [95 86 71] [155 17 14] [63 81 81] [78 42 30] [85 3 7] [12 23 7]],
   :Royal2 [[154 136 34] [245 205 180] [248 175 168] [253 221 160] [116 160 137]],
   :Moonrise2 [[121 142 135] [194 125 56] [204 197 145] [41 33 31]],
   :GrandBudapest2 [[230 160 196] [198 205 247] [216 164 153] [114 148 212]],
   :IsleofDogs1 [[153 134 165] [121 64 46] [204 186 114] [15 13 14] [217 208 211] [141 134 128]],
   :Chevalier1 [[68 100 85] [253 210 98] [211 221 220] [199 177 156]],
   :IsleofDogs2 [[234 211 191] [170 148 134] [182 133 77] [57 49 47] [28 23 24]],
   :Moonrise1 [[243 223 108] [206 171 7] [213 213 211] [36 40 26]],
   :Darjeeling2 [[236 203 174] [4 108 154] [214 156 78] [171 221 222] [0 0 0]],
   :Cavalcanti1 [[216 183 10] [2 64 27] [162 164 117] [129 168 141] [151 45 21]],
   :FrenchDispatch [[144 212 204] [189 48 39] [176 175 162] [127 192 198] [157 156 133]],
   :Rushmore1 [[225 189 109] [234 190 148] [11 119 94] [53 39 74] [242 48 15]],
   :GrandBudapest1 [[241 187 123] [253 100 103] [91 26 24] [214 114 54]],
   :FantasticFox1 [[221 141 41] [226 210 0] [70 172 200] [229 134 1] [180 15 32]],
   :Royal1 [[137 157 164] [201 51 18] [250 239 209] [220 134 59]]})
